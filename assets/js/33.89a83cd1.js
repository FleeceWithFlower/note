(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{220:function(e,a,s){"use strict";s.r(a);var t=s(0),v=Object(t.a)({},function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"mybatis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mybatis","aria-hidden":"true"}},[e._v("#")]),e._v(" Mybatis")]),e._v(" "),s("blockquote",[s("p",[e._v("持久层框架，封装JDBC，使开发者只关注SQL语句，使用ORM思想实现结果集封装。")])]),e._v(" "),s("p",[e._v("ORM（object relational mapping）")]),e._v(" "),s("blockquote",[s("p",[e._v("对象关系映射")])]),e._v(" "),s("h4",{attrs:{id:"sqlsessionfactorybuilder"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sqlsessionfactorybuilder","aria-hidden":"true"}},[e._v("#")]),e._v(" SqlSessionFactoryBuilder")]),e._v(" "),s("blockquote",[s("p",[e._v("解析资源，用于构建SqlSessionFactory")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('        InputStreamin =  Resources.getResourceAsStream("SqlMapConfig.xml");\n        SqlSessionFactoryBuilder sqlSessionFactoryBuilder = new SqlSessionFactoryBuilder();\n        SqlSessionFactory sqlSessionFactory = builder.build(in);\n')])])]),s("h4",{attrs:{id:"sqlsessionfactory"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sqlsessionfactory","aria-hidden":"true"}},[e._v("#")]),e._v(" SqlSessionFactory")]),e._v(" "),s("blockquote",[s("p",[e._v("用于构建SqlSession")])]),e._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",[e._v("一旦被创建就应该在应用的运行期间一直存在，没有任何理由丢弃它或重新创建另一个实例")])]),e._v(" "),s("h4",{attrs:{id:"sqlsession"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sqlsession","aria-hidden":"true"}},[e._v("#")]),e._v(" SqlSession")]),e._v(" "),s("blockquote",[s("p",[e._v("使用JDBD connection对象进行CRUD")])]),e._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",[e._v("每个线程都应该有它自己的 SqlSession 实例,所以它的最佳的作用域是请求或方法作用域。")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("try (SqlSession session = sqlSessionFactory.openSession()) {\n  // 你的应用逻辑代码\n}\n")])])]),s("h4",{attrs:{id:"映射器实例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#映射器实例","aria-hidden":"true"}},[e._v("#")]),e._v(" 映射器实例")]),e._v(" "),s("blockquote",[s("p",[e._v("映射器是一些绑定映射语句的接口。")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("try (SqlSession session = sqlSessionFactory.openSession()) {\n  BlogMapper mapper = session.getMapper(BlogMapper.class);\n  // 你的应用逻辑代码\n}\n")])])]),s("h2",{attrs:{id:"configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuration","aria-hidden":"true"}},[e._v("#")]),e._v(" configuration")]),e._v(" "),s("p",[e._v("properties")]),e._v(" "),s("blockquote",[s("p",[e._v("设置属性，属性可以在外部进行配置，并可以进行动态替换")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('<properties resource="org/mybatis/example/config.properties">\n  <property name="username" value="dev_user"/>\n  <property name="password" value="F2Fa3!33TYyg"/>\n</properties>\n<dataSource type="POOLED">\n  <property name="user" value="${user:root}"/>\x3c!--这是变量，并且设置了默认值--\x3e\n</dataSource>\n')])])]),s("p",[e._v(":::tap")]),e._v(" "),s("p",[e._v("先加载内部属性，在加载外部属性并相同属性替换。")]),e._v(" "),s("p",[e._v(":::")]),e._v(" "),s("p",[e._v("settings")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("cacheEnabled")]),e._v(" "),s("blockquote",[s("p",[e._v("开启全局缓存")])])]),e._v(" "),s("li",[s("p",[e._v("lazyLoadingEnabled")]),e._v(" "),s("blockquote",[s("p",[e._v("全局延迟加载")])])])]),e._v(" "),s("p",[e._v("typeAliases")]),e._v(" "),s("blockquote",[s("p",[e._v("配置别名，降低冗余的全限定类名书写")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('<typeAliases>\n  <typeAlias alias="Author" type="domain.blog.Author"/>\n</typeAliases>\n')])])]),s("p",[e._v("environments")]),e._v(" "),s("blockquote",[s("p",[e._v("定义环境变量")])]),e._v(" "),s("p",[e._v("mappers")]),e._v(" "),s("blockquote",[s("p",[e._v("配置 SQL 映射语句")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('    <mappers>\n        <package name="com/fleece/dao"/> \x3c!--目录名下所有配置文件--\x3e\n\x3c!--        <mapper resource="com/fleece/dao/IUserDao.xml"/>--\x3e\n    </mappers>\n')])])]),s("h2",{attrs:{id:"xml-映射器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#xml-映射器","aria-hidden":"true"}},[e._v("#")]),e._v(" XML 映射器")]),e._v(" "),s("blockquote",[s("p",[e._v("MyBatis 的真正强大在于它的语句映射,让用户能更专注于 SQL 代码。")])]),e._v(" "),s("p",[e._v("properties")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("id")]),e._v(" "),s("p",[e._v("在命名空间中唯一的标识符，可以被用来引用这条语句。")])]),e._v(" "),s("li",[s("p",[e._v("parameterType")]),e._v(" "),s("p",[e._v("将会传入这条语句的参数的类全限定名或别名。")])]),e._v(" "),s("li",[s("p",[e._v("resultType")]),e._v(" "),s("p",[e._v("期望从这条语句中返回结果的类全限定名或别名")])]),e._v(" "),s("li",[s("p",[e._v("resultMap")]),e._v(" "),s("p",[e._v("对外部 resultMap 的命名引用，结果映射是 MyBatis 最强大的特性。")])]),e._v(" "),s("li",[s("p",[e._v("useCache")]),e._v(" "),s("p",[e._v("是否启用二级缓存")])]),e._v(" "),s("li",[s("p",[e._v("flushCache")]),e._v(" "),s("p",[e._v("只要语句被调用，都会导致本地缓存和二级缓存被清空")])]),e._v(" "),s("li",[s("p",[e._v("useGeneratedKeys")]),e._v(" "),s("p",[e._v("MyBatis 使用 JDBC 的 getGeneratedKeys 方法来取出由数据库内部生成的主键（仅适用于 insert 和 update）")])]),e._v(" "),s("li",[s("p",[e._v("keyProperty")]),e._v(" "),s("p",[e._v("MyBatis 会使用 getGeneratedKeys 的返回值或 insert 语句的 selectKey 子元素设置它的值")])])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('<select\n  id="selectPerson"\n  parameterType="int"\n  resultType="hashmap"\n  resultMap="personResultMap"\n  useCache="true"\n  ">\n')])])]),s("h3",{attrs:{id:"主要标签"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#主要标签","aria-hidden":"true"}},[e._v("#")]),e._v(" 主要标签")]),e._v(" "),s("p",[e._v("select")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("id")]),e._v(" "),s("p",[e._v("唯一标识")])]),e._v(" "),s("li",[s("p",[e._v("parameterType")]),e._v(" "),s("p",[e._v("参数类型")])])]),e._v(" "),s("p",[e._v("insert")]),e._v(" "),s("p",[e._v("update")]),e._v(" "),s("p",[e._v("delete")]),e._v(" "),s("h4",{attrs:{id:"resultmap"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#resultmap","aria-hidden":"true"}},[e._v("#")]),e._v(" resultMap")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("属性")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("id")]),e._v(" "),s("p",[e._v("唯一标识")])]),e._v(" "),s("li",[s("p",[e._v("type")]),e._v(" "),s("p",[e._v("封装类型")])])])]),e._v(" "),s("li",[s("p",[e._v("标签")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("id")]),e._v(" "),s("p",[e._v("标记ID，作用同result，但可以提高整体性能")])]),e._v(" "),s("li",[s("p",[e._v("result")]),e._v(" "),s("p",[e._v("注入到字段或 JavaBean 属性的普通结果")])]),e._v(" "),s("li",[s("p",[e._v("association")]),e._v(" "),s("p",[e._v("配置关联表结果类型")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("javaType")]),e._v(" "),s("p",[e._v("返回类型")])]),e._v(" "),s("li",[s("p",[e._v("resultMap")]),e._v(" "),s("p",[e._v("将查询加过封装为指定map")])]),e._v(" "),s("li",[s("p",[e._v("columnPrefix")]),e._v(" "),s("p",[e._v("去除别名前缀")])]),e._v(" "),s("li",[s("p",[e._v("select")]),e._v(" "),s("p",[e._v("执行select语句并封装结果")])]),e._v(" "),s("li",[s("p",[e._v("column")]),e._v(" "),s("p",[e._v("作为参数传递给select")])])])]),e._v(" "),s("li",[s("p",[e._v("collection")]),e._v(" "),s("p",[e._v("和association相似，但返回List集合")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("ofType")]),e._v(" "),s("p",[e._v("集合中项的类型")])])])]),e._v(" "),s("li",[s("p",[e._v("discriminator")]),e._v(" "),s("p",[e._v("数据库查询同一字段可能返回不用的类型，用于鉴别类型")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('  <discriminator javaType="int" column="vehicle_type">\n    <case value="1" resultMap="carResult"/>\n    <case value="2" resultMap="truckResult"/>\t\n  </discriminator>\n')])])])])])])]),e._v(" "),s("h2",{attrs:{id:"动态-sql"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#动态-sql","aria-hidden":"true"}},[e._v("#")]),e._v(" 动态 SQL")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("if")]),e._v(" "),s("p",[e._v("用于判断")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("test")]),e._v(" "),s("p",[e._v("表达式")])])])]),e._v(" "),s("li",[s("p",[e._v("choose")]),e._v(" "),s("p",[e._v("同"),s("code",[e._v("swith")]),e._v(" 语句")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('  <choose>\n    <when test="title != null">\n      AND title like #{title}\n    </when>\n    <otherwise>\n      AND featured = 1\n    </otherwise>\n  </choose>\n')])])])]),e._v(" "),s("li",[s("p",[s("em",[e._v("where")])])])]),e._v(" "),s("p",[e._v("同where语句")]),e._v(" "),s("ul",[s("li",[s("h3",{attrs:{id:"foreach"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#foreach","aria-hidden":"true"}},[e._v("#")]),e._v(" foreach")]),e._v(" "),s("p",[e._v("循环")])]),e._v(" "),s("li",[s("p",[e._v("bind")]),e._v(" "),s("p",[e._v("创建变量")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("<bind name=\"pattern\" value=\"'%' + _parameter.getTitle() + '%'\" />\n")])])])])])])},[],!1,null,null,null);a.default=v.exports}}]);