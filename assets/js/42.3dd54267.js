(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{227:function(e,t,a){"use strict";a.r(t);var s=a(0),r=Object(s.a)({},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"koa2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#koa2","aria-hidden":"true"}},[e._v("#")]),e._v(" KOA2")]),e._v(" "),a("p",[e._v("Koa 是一个新的 web 框架，由 Express 幕后的原班人马打造， 致力于成为 web 应用和 API 开发领域中的一个更小、更富有表现力、更健壮的基石。 通过利用 async 函数，Koa 帮你丢弃回调函数，并有力地增强错误处理。 Koa 并没有捆绑任何中间件， 而是提供了一套优雅的方法，帮助您快速而愉快地编写服务端应用程序。")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("app.use(async (ctx, next) => {\n  await next();\n  const rt = ctx.response.get('X-Response-Time');\n  console.log(`${ctx.method} ${ctx.url} - ${rt}`);\n});\n")])])]),a("h2",{attrs:{id:"关键字"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关键字","aria-hidden":"true"}},[e._v("#")]),e._v(" 关键字")]),e._v(" "),a("h3",{attrs:{id:"设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置","aria-hidden":"true"}},[e._v("#")]),e._v(" 设置")]),e._v(" "),a("ul",[a("li",[e._v("app.env")])]),e._v(" "),a("p",[e._v("环境变量")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("app.keys")]),e._v(" "),a("p",[e._v("签名的 cookie 密钥数组")])])]),e._v(" "),a("h3",{attrs:{id:"app"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#app","aria-hidden":"true"}},[e._v("#")]),e._v(" app")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("app.listen()")]),e._v(" "),a("p",[e._v("语法糖 ，监听端口")]),e._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[e._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("createServer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])])]),e._v(" "),a("li",[a("p",[e._v("app.use()")]),e._v(" "),a("p",[e._v("中间件")])]),e._v(" "),a("li",[a("p",[e._v("app.keys")]),e._v(" "),a("p",[e._v("设置签名的 Cookie 密钥。")])]),e._v(" "),a("li",[a("p",[e._v("app.on")]),e._v(" "),a("p",[e._v("触发事件")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("app.on('error', err => {\n  log.error('server error', err)\n});\n")])])])])]),e._v(" "),a("h3",{attrs:{id:"context"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#context","aria-hidden":"true"}},[e._v("#")]),e._v(" Context")]),e._v(" "),a("p",[e._v("Koa Context 将 node 的 "),a("code",[e._v("request")]),e._v(" 和 "),a("code",[e._v("response")]),e._v(" 对象封装到单个对象中")]),e._v(" "),a("ul",[a("li",[a("h3",{attrs:{id:"ctx-req"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ctx-req","aria-hidden":"true"}},[e._v("#")]),e._v(" ctx.req")]),e._v(" "),a("p",[e._v("Node 的 "),a("code",[e._v("request")]),e._v(" 对象.")])]),e._v(" "),a("li",[a("h3",{attrs:{id:"ctx-res"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ctx-res","aria-hidden":"true"}},[e._v("#")]),e._v(" ctx.res")]),e._v(" "),a("p",[e._v("Node 的 "),a("code",[e._v("response")]),e._v(" 对象")])]),e._v(" "),a("li",[a("h3",{attrs:{id:"ctx-request"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ctx-request","aria-hidden":"true"}},[e._v("#")]),e._v(" ctx.request")]),e._v(" "),a("p",[e._v("koa 的 "),a("code",[e._v("Request")]),e._v(" 对象.")])]),e._v(" "),a("li",[a("h3",{attrs:{id:"ctx-response"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ctx-response","aria-hidden":"true"}},[e._v("#")]),e._v(" ctx.response")]),e._v(" "),a("p",[e._v("koa 的 "),a("code",[e._v("Response")]),e._v(" 对象.")])]),e._v(" "),a("li",[a("h3",{attrs:{id:"ctx-state"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ctx-state","aria-hidden":"true"}},[e._v("#")]),e._v(" ctx.state")]),e._v(" "),a("p",[e._v("推荐的命名空间，用于通过中间件传递信息和你的前端视图")])]),e._v(" "),a("li",[a("h3",{attrs:{id:"ctx-app"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ctx-app","aria-hidden":"true"}},[e._v("#")]),e._v(" ctx.app")]),e._v(" "),a("p",[e._v("应用程序实例引用")])]),e._v(" "),a("li",[a("h3",{attrs:{id:"ctx-app-emit"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ctx-app-emit","aria-hidden":"true"}},[e._v("#")]),e._v(" ctx.app.emit")]),e._v(" "),a("p",[e._v("触发事件")])]),e._v(" "),a("li",[a("p",[e._v("ctx.cookies.get(name, [options])")]),e._v(" "),a("p",[e._v("获取cookie")])]),e._v(" "),a("li",[a("p",[e._v("ctx.cookies.set(name, value, [options])")]),e._v(" "),a("p",[e._v("设置cookie")])]),e._v(" "),a("li",[a("p",[e._v("ctx.throw([status], [msg], [properties])")]),e._v(" "),a("p",[e._v("用来抛出一个包含 "),a("code",[e._v(".status")]),e._v(" 属性错误的帮助方法")])]),e._v(" "),a("li",[a("p",[e._v("ctx.assert(value, [status], [msg], [properties])")]),e._v(" "),a("p",[e._v("当 "),a("code",[e._v("!value")]),e._v(" 时抛出一个类似 "),a("code",[e._v(".throw")]),e._v(" 错误的帮助方法。")])])]),e._v(" "),a("h3",{attrs:{id:"request"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#request","aria-hidden":"true"}},[e._v("#")]),e._v(" Request")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("request.headers")]),e._v(" "),a("p",[e._v("请求头对象")])]),e._v(" "),a("li",[a("p",[e._v("request.method")]),e._v(" "),a("p",[e._v("请求方法")])]),e._v(" "),a("li",[a("p",[e._v("request.url")]),e._v(" "),a("p",[e._v("获取请求 URL.")])]),e._v(" "),a("li",[a("p",[e._v("request.originalUrl")]),e._v(" "),a("p",[e._v("获取请求原始URL")])]),e._v(" "),a("li",[a("h3",{attrs:{id:"request-origin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#request-origin","aria-hidden":"true"}},[e._v("#")]),e._v(" request.origin")]),e._v(" "),a("p",[e._v("获取URL的来源")])]),e._v(" "),a("li",[a("h3",{attrs:{id:"request-href"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#request-href","aria-hidden":"true"}},[e._v("#")]),e._v(" request.href")]),e._v(" "),a("p",[e._v("获取完整的请求URL")])]),e._v(" "),a("li",[a("h3",{attrs:{id:"request-path"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#request-path","aria-hidden":"true"}},[e._v("#")]),e._v(" request.path")]),e._v(" "),a("p",[e._v("获取请求路径名。")])]),e._v(" "),a("li",[a("h3",{attrs:{id:"request-querystring"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#request-querystring","aria-hidden":"true"}},[e._v("#")]),e._v(" request.querystring")]),e._v(" "),a("p",[e._v("根据 "),a("code",[e._v("?")]),e._v(" 获取原始查询字符串.//返回字符串无 ？")])]),e._v(" "),a("li",[a("h3",{attrs:{id:"request-search"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#request-search","aria-hidden":"true"}},[e._v("#")]),e._v(" request.search")]),e._v(" "),a("p",[e._v("使用 "),a("code",[e._v("?")]),e._v(" 获取原始查询字符串。//返回字符串有 ？")])]),e._v(" "),a("li",[a("p",[e._v("request.query")]),e._v(" "),a("p",[e._v("获取解析的查询字符串 ，返还对象")])]),e._v(" "),a("li",[a("h3",{attrs:{id:"request-type"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#request-type","aria-hidden":"true"}},[e._v("#")]),e._v(" request.type")]),e._v(" "),a("p",[e._v("获取请求 "),a("code",[e._v("Content-Type")])])]),e._v(" "),a("li",[a("h3",{attrs:{id:"request-charset"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#request-charset","aria-hidden":"true"}},[e._v("#")]),e._v(" request.charset")]),e._v(" "),a("p",[e._v("存在时获取请求字符集")])])]),e._v(" "),a("h3",{attrs:{id:"response"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#response","aria-hidden":"true"}},[e._v("#")]),e._v(" Response")]),e._v(" "),a("ul",[a("li",[a("h3",{attrs:{id:"response-headers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#response-headers","aria-hidden":"true"}},[e._v("#")]),e._v(" response.headers")]),e._v(" "),a("p",[e._v("响应头对象")])]),e._v(" "),a("li",[a("p",[e._v("response.get(field)")]),e._v(" "),a("p",[e._v("不区分大小写获取响应头字段值 "),a("code",[e._v("field")]),e._v("。")])]),e._v(" "),a("li",[a("p",[e._v("response.set(field, value)")]),e._v(" "),a("p",[e._v("设置响应头 "),a("code",[e._v("field")]),e._v(" 到 "),a("code",[e._v("value")]),e._v(":")])]),e._v(" "),a("li",[a("p",[e._v("response.has(field)")]),e._v(" "),a("p",[e._v("判断是否有响应头")])]),e._v(" "),a("li",[a("p",[e._v("response.append(field, value)")]),e._v(" "),a("p",[e._v("附加响应头")])]),e._v(" "),a("li",[a("p",[e._v("response.remove(field)")]),e._v(" "),a("p",[e._v("删除响应头")])]),e._v(" "),a("li",[a("h3",{attrs:{id:"response-status"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#response-status","aria-hidden":"true"}},[e._v("#")]),e._v(" response.status")]),e._v(" "),a("p",[e._v("获取/设置 响应状态")])]),e._v(" "),a("li",[a("h3",{attrs:{id:"response-message"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#response-message","aria-hidden":"true"}},[e._v("#")]),e._v(" response.message")]),e._v(" "),a("p",[e._v("获取/设置 响应的状态消息")])]),e._v(" "),a("li",[a("p",[e._v("response.body")]),e._v(" "),a("p",[e._v("获取响应主体。")])]),e._v(" "),a("li",[a("p",[e._v("response.redirect(url, [alt])")]),e._v(" "),a("p",[e._v("执行重定向")])])])])},[],!1,null,null,null);t.default=r.exports}}]);