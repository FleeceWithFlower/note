```
import * as React from "react";import './index.css'import {Form, InputNumber, Select, Popconfirm, Modal, Radio} from 'antd';import {Upload, message, Button, Input, Checkbox} from 'antd';import {UploadOutlined} from '@ant-design/icons';import {EditableTable} from '../../component/EditableTable/EditableTable'import {CheckboxFunction} from './component/CheckboxFunction/CheckboxFunction'import { InboxOutlined } from '@ant-design/icons';const {Option} = Select;const { Dragger } = Upload;let XLSX = require('xlsx')export interface IState {    rankingChecked:boolean,    averageScoreChecked:boolean,    tables: Array<any>,    showTotalPoints: boolean,    radioChecked: boolean,    subjects: Array<any>,    classes: Array<any>,    showModule: boolean}export default class UploadPage extends React.Component<{}, IState> {    constructor(props: any) {        super(props);        this.state = {            radioChecked:false,//计算总分            rankingChecked:false,//排名            averageScoreChecked:false,//平均分            showModule: false,            classes: [10, 11],            subjects: [                {                    title: '语文',                    code: '100001'                },                {                    title: '数学',                    code: '100002'                },                {                    title: '英语',                    code: '100003'                },                {                    title: '科学',                    code: '100004'                },                {                    title: '社会_法治',                    code: '100005'                }            ],            showTotalPoints: false,            tables:[]            /*       tables: [                {                    "姓名": "陈磊",                    "语文": 81,                    "数学": 98,                    "英语": 89.5,                    "科学": 89,                    "社会_法治": 88                },                {                    "姓名": "黄程余",                    "语文": 87,                    "数学": 91,                    "英语": 88.5,                    "科学": 88,                    "社会_法治": 83                },                {"姓名": "李以诺", "语文": 81.5, "数学": 97, "英语": 93.5, "科学": 82, "社会_法治": 81},                {                    "姓名": "金嘉欣",                    "语文": 85.5,                    "数学": 85,                    "英语": 95,                    "科学": 85,                    "社会_法治": 83                }, {"姓名": "钱孟德", "语文": 75, "数学": 95, "英语": 88.5, "科学": 87, "社会_法治": 86}, {                    "姓名": "陈剑博",                    "语文": 75,                    "数学": 85,                    "英语": 97.5,                    "科学": 82,                    "社会_法治": 83                }, {"姓名": "黄玉帛", "语文": 82, "数学": 88, "英语": 91, "科学": 82, "社会_法治": 75}, {                    "姓名": "徐步帅",                    "语文": 68,                    "数学": 94,                    "英语": 94.5,                    "科学": 85,                    "社会_法治": 76                }, {"姓名": "何芷璇", "语文": 74, "数学": 81, "英语": 97, "科学": 80, "社会_法治": 78}, {                    "姓名": "陈健宇",                    "语文": 73.5,                    "数学": 94,                    "英语": 91,                    "科学": 78,                    "社会_法治": 73                }, {"姓名": "周馨瑜", "语文": 72, "数学": 89, "英语": 91.5, "科学": 78, "社会_法治": 77}, {                    "姓名": "张联锵",                    "语文": 69,                    "数学": 81,                    "英语": 93,                    "科学": 90,                    "社会_法治": 73                }, {"姓名": "李辉煌", "语文": 74, "数学": 91, "英语": 86, "科学": 80, "社会_法治": 75}, {                    "姓名": "陈晨",                    "语文": 74.5,                    "数学": 89,                    "英语": 92,                    "科学": 77,                    "社会_法治": 70                }, {"姓名": "陈宣鑫", "语文": 76.5, "数学": 81, "英语": 86, "科学": 78, "社会_法治": 80}, {                    "姓名": "罗笛夏",                    "语文": 81.5,                    "数学": 88,                    "英语": 85.5,                    "科学": 72,                    "社会_法治": 72                }, {"姓名": "蔡诗露", "语文": 81.5, "数学": 81, "英语": 88.5, "科学": 71, "社会_法治": 77}, {                    "姓名": "郑家欣",                    "语文": 87,                    "数学": 71,                    "英语": 90.5,                    "科学": 71,                    "社会_法治": 77                }, {"姓名": "朱为铎", "语文": 75.5, "数学": 90, "英语": 80.5, "科学": 77, "社会_法治": 70}, {                    "姓名": "章国枨",                    "语文": 74.5,                    "数学": 77,                    "英语": 85,                    "科学": 76,                    "社会_法治": 75                }, {"姓名": "叶翔名", "语文": 67, "数学": 80, "英语": 87, "科学": 78, "社会_法治": 74}, {                    "姓名": "徐昊",                    "语文": 73.5,                    "数学": 81,                    "英语": 87,                    "科学": 65,                    "社会_法治": 63                }, {"姓名": "陈倩倩", "语文": 72.5, "数学": 72, "英语": 89.5, "科学": 64, "社会_法治": 71}, {                    "姓名": "郭永蘅",                    "语文": 63,                    "数学": 88,                    "英语": 64,                    "科学": 75,                    "社会_法治": 78                }, {"姓名": "杨邦发", "语文": 67, "数学": 83, "英语": 72, "科学": 70, "社会_法治": 74}, {                    "姓名": "郑高想",                    "语文": 72,                    "数学": 86,                    "英语": 54.5,                    "科学": 76,                    "社会_法治": 74                }, {"姓名": "冯思杰", "语文": 67.5, "数学": 77, "英语": 80, "科学": 75, "社会_法治": 62}, {                    "姓名": "林乾栩",                    "语文": 71,                    "数学": 75,                    "英语": 84,                    "科学": 69,                    "社会_法治": 61                }, {"姓名": "包一然", "语文": 73.5, "数学": 77, "英语": 71.5, "科学": 65, "社会_法治": 69}, {                    "姓名": "黄辉晨",                    "语文": 73.5,                    "数学": 80,                    "英语": 43,                    "科学": 80,                    "社会_法治": 78                }, {"姓名": "陈强", "语文": 75, "数学": 81, "英语": 68.5, "科学": 69, "社会_法治": 60}, {                    "姓名": "陈小丽",                    "语文": 69.5,                    "数学": 69,                    "英语": 85,                    "科学": 44,                    "社会_法治": 57                }, {"姓名": "王道鹏", "语文": 68, "数学": 68, "英语": 56.5, "科学": 59, "社会_法治": 68}, {                    "姓名": "侯胡欣",                    "语文": 65,                    "数学": 87,                    "英语": 60.5,                    "科学": 52,                    "社会_法治": 55                }, {"姓名": "郑思林", "语文": 64, "数学": 70, "英语": 58, "科学": 58, "社会_法治": 66}, {                    "姓名": "林传海",                    "语文": 57.5,                    "数学": 77,                    "英语": 56.5,                    "科学": 64,                    "社会_法治": 58                }, {"姓名": "黄章璋", "语文": 76.5, "数学": 45, "英语": 71.5, "科学": 57, "社会_法治": 52}, {                    "姓名": "姜增帅",                    "语文": 55.5,                    "数学": 70,                    "英语": 56.5,                    "科学": 62,                    "社会_法治": 54                }, {"姓名": "陈晨", "语文": 65, "数学": 39, "英语": 69.5, "科学": 27, "社会_法治": 45}, {                    "姓名": "季忠乐",                    "语文": 49.5,                    "数学": 69,                    "英语": 23,                    "科学": 53,                    "社会_法治": 40                }]*/        }    }    a() {        let arr = []        for (let key in this.state.tables[0]) {            arr.push(key)        }        return arr    }    render() {        return (            <div>                <div className="flex direction-column align-center  w-100 ">                    <div className=" flex direction-column align-center" style={{width : 500}}>                        <div>                            <div className="flex align-center" >                                <label>考试名称：</label>                                <div style={{width: "200px"}}>                                    <Input placeholder="输入考试名称"/>                                </div>                            </div>                            <div className="flex align-center mt-40" >                                <div>选择班级：</div>                                <Select defaultValue={this.state.classes[0]} style={{width: 200}}>                                    {this.state.classes.map((item) => {                                        return <Option value={item}>                                            {item}                                        </Option>                                    })}                                </Select>                            </div>                            <div className="mt-40">                                <Checkbox.Group options={['计算总分','排名','平均分']} defaultValue={['计算总分','排名','平均分']} onChange={(e) => this.checkboxOnChange(e)} />                            </div>                        </div>                        <div className="mt-40" style={{width: 400}}>                            <Dragger showUploadList={false} customRequest={(e) => this.customRequest(e)}>                                <p className="ant-upload-drag-icon">                                    <InboxOutlined />                                </p>                                <p className="ant-upload-text">点击或将文件拖拽到这里上传</p>                                <p className="ant-upload-hint">支持.xlsx .xls 文件</p>                            </Dragger>                        </div>                        <div className="mt-40" style={{width: 200}}>                            <Button type="primary" block >下一步</Button>                        </div>                    </div>                </div>            </div>)    }    checkboxOnChange(e:any){        console.log(e);    }    onChange(e: any) {        if (e.target.checked) {            this.setState((state, props) => ({                showModule: true            }));        }        this.setState((state, props) => ({            radioChecked: false        }));    }    onTapRadio(e: any) {        this.setState((state, props) => ({            radioChecked: false        }));        let document: any = window.document.getElementById("totalPoints")        document.checked = false    }    onChangeRadio(e: any) {        console.log(e);    }    changeTables(data: any): any {        this.setState((state, props) => ({            tables: data        }));    }    customRequest(event: any) {        let fileReader = new FileReader();        let that = this;        fileReader.onload = function (e) {            // @ts-ignore            let arrayBufferData = new Uint8Array(e.target.result)            var wopts = {type: 'array'};            var workbook = XLSX.read(arrayBufferData, wopts);            let json = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);            console.log(JSON.stringify(json));            that.setState((state, props) => ({                tables: json,            }))        }        fileReader.readAsArrayBuffer(event.file)    }    onTapAverageScore() {        let {tables} = this.state        let obj = {            '语文': 0,            '数学': 0,            '英语': 0,            '科学': 0,            '社会_法治': 0,            '总分': 0,        }        tables.forEach(item => {            for (let key in item) {                // @ts-ignore                if (obj[key] === 0 || obj[key]) {                    // @ts-ignore                    // @ts-ignore                    obj[key] = obj[key] + item[key]                }            }        })        for (let key in obj) {            // @ts-ignore            obj[key] = Math.floor(obj[key] / tables.length)        }        // @ts-ignore        obj['姓名'] = '平均分'        tables.push(obj)        this.setState((state, props) => ({            tables: tables,        }))    }//计算平均分    onTapRank() {        function sortNumber(a: any, b: any) {            return b['总分'] - a['总分']        }        let {tables} = this.state        let newTables = tables.sort(sortNumber)        let arr = newTables.map((item, index) => {            return {                ...item,                '排名': index + 1            }        })        this.setState((state, props) => ({            tables: arr,        }))    } //计算排名    onTapTotalPoints(subjects: any) {        /*        let {tables} = this.state                let arr = tables.map(item => {                    let totalPoints = 0;                    for (let key in item) {                        let status = subjects.find(subject => subject === key)                        if (status) totalPoints += Number(item[key])                    }                    return {                        ...item,                        '总分': totalPoints                    }                })                this.setState((state, props) => ({                    tables: arr,                }))*/    }  //计算总分    onTapTotalPointsHandleOk() {        this.setState((state, props) => ({            radioChecked: true,            showModule: false        }));    } //总分的ok    onTapTotalPointsHandleCancel() {        this.setState((state, props) => ({            showModule: false        }));    } //总分的取消}
```