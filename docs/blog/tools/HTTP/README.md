## HTTP

超文本传输协议(HyperText Transfer Protocal)



### 特点

无状态协议

基于TCP/IP

### 请求报文

请求报文由 请求方法、请求URI、协议版本、首部字段和内容实体构成

响应报文由HTTP版本、状态码、原因短句、日期、首部字段、实体主体



### 请求方法

| 1    | GET     | 请求指定的页面信息，并返回实体主体。                         |
| ---- | ------- | ------------------------------------------------------------ |
| 2    | HEAD    | 类似于 GET 请求，只不过返回的响应中没有具体的内容，用于获取报头 |
| 3    | POST    | 向指定资源提交数据进行处理请求（例如提交表单或者上传文件）。数据被包含在请求体中。POST 请求可能会导致新的资源的建立和/或已有资源的修改。 |
| 4    | PUT     | 从客户端向服务器传送的数据取代指定的文档的内容。             |
| 5    | DELETE  | 请求服务器删除指定的页面。                                   |
| 6    | CONNECT | HTTP/1.1 协议中预留给能够将连接改为管道方式的代理服务器。    |
| 7    | OPTIONS | 允许客户端查看服务器的性能。                                 |
| 8    | TRACE   | 回显服务器收到的请求，主要用于测试或诊断。                   |
| 9    | PATCH   | 是对 PUT 方法的补充，用来对已知资源进行局部更新 。           |

### 持久连接

Connection: keep-alive

任意一方没有明确提出断开连接，则保持TCP连接状态。

### Cookie

>  保存无状态协议这个特征的同时又要解决类似的矛盾问题，于是诞生了Cookie

### 实体

### 报文

> 用于HTTP交互的信息称为报文

报文由报文首部和报文主体构成

请求报文首部包括：

1. 请求行
2. 请求首部字段
3. 通用首部字段
4. 实体首部字段

响应报文首部包括：

- 同上





### 报文主体

HTTP首部

### HTTP首部字段

根据不同上下文，可将首部字段分为：

- 一般首首部字段: 同时适用于请求和响应消息，但与最终消息主体中传输的数据无关的消息头。
- 请求首部字段: 包含更多有关要获取的资源或客户端本身信息的消息头。
- 响应首部字段: 包含有关响应的补充信息，如其位置或服务器本身（名称和版本等）的消息头。
- 实体首部字段: 包含有关实体主体的更多信息，比如主体长(Content-Length)度或其MIME类型。

Content-Type：text/html

表示报文主体的对象类型

### 范围请求

> 指定范围发送的请求叫做范围请求

Range:betes=5001-10000l

响应状态码206

### 内容编码

内容编码指明应用在实体内容的编码格式

常见的内容编码有

- gzip(GNU zip)
- compress(UNIX 系统的标准压缩)
- deflate（zlib）
- identity（不进行编码）

### 分块传输编码

把实体主体分块

### 内容协商

内容协商是指客户端和服务端就响应的资源内容进行交涉，然后提供给客户端最适合的资源。会以语言、字符集、编码方式等为基准判断响应的资源。

### 状态码

描述返回的请求结果。

| 分类 | 分类描述                                       |
| :--- | :--------------------------------------------- |
| 1**  | 信息，服务器收到请求，需要请求者继续执行操作   |
| 2**  | 成功，操作被成功接收并处理                     |
| 3**  | 重定向，需要进一步的操作以完成请求             |
| 4**  | 客户端错误，请求包含语法错误或无法完成请求     |
| 5**  | 服务器错误，服务器在处理请求的过程中发生了错误 |

常用状态码

| 2xx  |                 |                                                              |
| ---- | --------------- | ------------------------------------------------------------ |
| 200  | OK              | 请求成功。一般用于GET与POST请求                              |
| 204  | No Content      | 无内容。服务器成功处理，但未返回内容。在未更新网页的情况下，可确保浏览器继续显示当前文档 |
| 206  | Partial Content | 部分内容。服务器成功处理了部分GET请求                        |

| 3xx  |                    |                                                              |
| ---- | ------------------ | ------------------------------------------------------------ |
| 301  | Moved Permanently  | 永久移动。请求的资源已被永久的移动到新URI，返回信息会包括新的URI，浏览器会自动定向到新URI。今后任何新的请求都应使用新的URI代替 |
| 302  | Found              | 临时移动。与301类似。但资源只是临时被移动。客户端应继续使用原有URI |
| 303  | See Other          | 查看其它地址。与301类似。使用GET和POST请求查看               |
| 304  | Not Modified       | 未修改。所请求的资源未修改，服务器返回此状态码时，不会返回任何资源。客户端通常会缓存访问过的资源，通过提供一个头信息指出客户端希望只返回在指定日期之后修改的资源 |
| 307  | Temporary Redirect | 临时重定向。与302类似。使用GET请求重定向                     |

| 4xx  |              |                                                              |
| ---- | ------------ | ------------------------------------------------------------ |
| 400  | Bad Request  | 客户端请求的语法错误，服务器无法理解                         |
| 401  | Unauthorized | 请求要求用户的身份认证                                       |
| 403  | Forbidden    | 服务器理解请求客户端的请求，但是拒绝执行此请求               |
| 404  | Not Found    | 服务器无法根据客户端的请求找到资源（网页）。通过此代码，网站设计人员可设置"您所请求的资源无法找到"的个性页面 |

| 5xx  |                       |                                                              |
| ---- | --------------------- | ------------------------------------------------------------ |
| 500  | Internal Server Error | 服务器内部错误，无法完成请求                                 |
| 503  | Service Unavailable   | 由于超载或系统维护，服务器暂时的无法处理客户端的请求。延时的长度可包含在服务器的Retry-After头信息中 |

### 虚拟主机

物理层只有一台服务器，但是可以搭建多个web站点，假想已有多台服务器。

### 代理

代理是一种有转发功能的应用程序

### 网关

网关是转发其他服务器通信数据的服务器

### 隧道

隧道是在相隔甚远的客户端和服务器两者之间进行中转，并保持双方通信连接的应用程序





### 用户代理

user-agent 就是任何能够为用户发起行为的工具

### 请求过程

浏览器首先发送一个请求来获取页面的HTML文档，再解析文档中的资源信息发送其他请求，获取可执行脚本或CSS样式来进行页面布局渲染，以及一些其它页面资源（如图片和视频等）。

### 代理（Proxies） 

在浏览器和服务器之间，有许多计算机和其他设备转发了HTTP消息。

代理主要有如下几种作用：

- 缓存（可以是公开的也可以是私有的，像浏览器的缓存）
- 过滤（像反病毒扫描，家长控制...）
- 负载均衡（让多个服务器服务不同的请求）
- 认证（对不同资源进行权限管理）
- 日志记录（允许存储历史信息）

### HTTP 是无状态，有会话的

HTTP本质是无状态的，使用Cookies可以创建有状态的会话。

使用HTTP的头部扩展，把Cookies添加到头部中，创建一个会话让每次请求都能共享相同的上下文信息，达成相同的状态。

### HTTP头

根据不同上下文，可将消息头分为：

- [一般头](https://developer.mozilla.org/zh-CN/docs/Glossary/一般头): 同时适用于请求和响应消息，但与最终消息主体中传输的数据无关的消息头。
- [请求头](https://developer.mozilla.org/zh-CN/docs/Glossary/请求头): 包含更多有关要获取的资源或客户端本身信息的消息头。
- [响应头](https://developer.mozilla.org/zh-CN/docs/Glossary/响应头): 包含有关响应的补充信息，如其位置或服务器本身（名称和版本等）的消息头。
- [实体头](https://developer.mozilla.org/zh-CN/docs/Glossary/实体头): 包含有关实体主体的更多信息，比如主体长(Content-Length)度或其MIME类型。

### HTTP 缓存

> 缓存是一种保存资源副本并在下次请求时直接使用该副本的技术。

缓存类型

> NO cache (没缓存)
>
> Shared cache(共享缓存)
>
> Local(private) cache(本地缓存)

缓存目标

> 常见的 HTTP 缓存只能存储 [`GET`](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/GET) 响应

## 关键字

- HTTP

超文本传输协议(HyperText Transfer Protocal)

- 报文 

用于HTTP协议交互的信息被称为报文

- 请求行

由请求方法，请求地址，HTTP版本号 构成

- 响应行

由HTTP版本号，状态码，原因短句 构成

- 持久连接

Connection: keep-alive

任意一方没有明确提出断开连接，则保持TCP连接状态。

- Cookie

保存无状态协议这个特征的同时又要解决类似的矛盾问题，于是诞生了Cookie，用于管理状态。

- 用户代理

user-agent 就是任何能够为用户发起行为的工具

- 内容编码

内容编码指明应用在实体内容的编码格式

- 范围请求

Range:betes=5001-10000l

指定范围发送的请求叫做范围请求

- 分块传输编码

把实体主体分块

- 内容编码 

内容编码指明应用在实体内容的编码格式

- 

- 虚拟主机

物理层只有一台服务器，但是可以搭建多个web站点，假想已有多台服务器。

- 代理

代理是一种有转发功能的应用程序

- 网关

网关是转发其他服务器通信数据的服务器

- 隧道

隧道是在相隔甚远的客户端和服务器两者之间进行中转，并保持双方通信连接的应用程序

- Content-Type：text/html

表示报文主体的对象类型

- 常用状态码

| 常用状态码 |                                                        |
| ---------- | ------------------------------------------------------ |
| 200        | 请求成功                                               |
| 204        | 无内容                                                 |
| 206        | 部分内容                                               |
| 301        | 永久移动                                               |
| 302        | 临时移动                                               |
| 303        | 查看其它地址                                           |
| 304        | 未修改                                                 |
| 307        | 临时重定向                                             |
| 400        | 客户端请求的语法错误                                   |
| 401        | 请求要求用户的身份认证                                 |
| 403        | 服务器理解请求客户端的请求，但是拒绝执行此请求         |
| 404        | 服务器无法根据客户端的请求找到资源（网页）             |
| 500        | 服务器内部错误，无法完成请求                           |
| 503        | 由于超载或系统维护，服务器暂时的无法处理客户端的请求。 |

- HTTP首部字段一览

| 通用首部字段  | 说明           |
| ------------- | -------------- |
| Cache-Control | 控制缓存的行为 |
|               |                |
|               |                |
|               |                |
|               |                |
|               |                |
|               |                |
|               |                |

